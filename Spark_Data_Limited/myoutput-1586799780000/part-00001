{"title_page": "Simon (cipher)", "text_new": "{{NPOV|date=June 2018}}\n{{Infobox block cipher\n| name          = Simon\n| image         = [[Image:Simon block cipher.svg|280px|center]]\n| caption       = One round of Simon\n| designers     = Ray Beaulieu, Douglas Shors, Jason Smith, Stefan Treatman-Clark, Bryan Weeks, Louis Wingers [[National Security Agency|NSA]]\n| publish date  = 2013<ref name=eprintSimon />\n| derived from  =\n| derived to    =\n| related to    = [[Speck (cipher)|Speck]]\n| certification =\n| key size      = 64, 72, 96, 128, 144, 192 or 256 bits\n| block size    = 32, 48, 64, 96 or 128 bits\n| structure     = Balanced [[Feistel network]]\n| rounds        = 32, 36, 42, 44, 52, 54, 68, 69 or 72 (depending on block and key size)\n| speed         = 7.5 [[cycles per byte|cpb]] (21.6 without [[Streaming SIMD Extensions|SSE]]) on Intel Xeon 5640 (Simon128/128)\n| cryptanalysis = [[Differential cryptanalysis]] can break 46 rounds of Simon128/128 with 2<sup>125.6</sup> data, 2<sup>40.6</sup> bytes memory and time complexity of 2<sup>125.7</sup> with success rate of 0.632.<ref>{{cite web|title=Differential and Linear Cryptanalysis of Reduced-Round Simon|url=https://eprint.iacr.org/2013/526|accessdate=2014-04-16}}</ref><ref>{{cite conference |url=https://www.iacr.org/workshops/fse2014/slides-09_1.pdf |authors=Farzaneh Abed, Eik List, [[Stefan Lucks]], Jakob Wenzel |date=5 March 2014 |title=Differential Cryptanalysis of Round-Reduced Simon and Speck |conference=[[Fast Software Encryption|FSE]] 2014 |work=conference slides}}</ref><ref>{{cite document|authors=Hoda Alkhzaimi, Martin Lauridsen |date=28 Aug 2013 |title=Cryptanalysis of the SIMON Family of Block Ciphers|url=https://eprint.iacr.org/2013/543.pdf}}</ref>}}\n\n'''Simon''' is a family of lightweight [[block cipher]]s publicly released by the [[National Security Agency]] (NSA) in June 2013.<ref>{{cite web|last=Schneier|first=Bruce|title=SIMON and SPECK: New NSA Encryption Algorithms |work=Schneier on Security |url=https://www.schneier.com/blog/archives/2013/07/simon_and_speck.html|accessdate=2013-07-17}}</ref><ref name=eprintSimon /> Simon has been optimized for performance in hardware implementations, while its sister algorithm, [[Speck (cipher)|Speck]], has been optimized for software implementations.<ref>{{cite web |url=http://www.rfidjournal.com/articles/view?13288 |author=Claire Swedberg |date=17 July 2015 |title=NSA Offers Block Ciphers to Help Secure RFID Transmissions |work=RFID Journal }}</ref><ref name=ieeeSimonTool>{{cite journal |author=Brian Degnan and Gregory Durgin |date=10 November 2017 |title=Simontool: Simulation Support for the Simon Cipher |journal=IEEE Journal of Radio Frequency Identification |volume=1 |issue=2 |pages=195\u2013201 |doi=10.1109/JRFID.2017.2771216 |bibcode=2017IJRFI...1..195D }}</ref>\n\nThe NSA began working on the Simon and Speck ciphers in 2011. The agency anticipated some agencies in the US federal government would need a cipher that would operate well on a diverse collection of [[Internet of Things]] devices while maintaining an acceptable level of security.<ref name=Beaulieu2015>{{cite web\n | title=Simon and Speck: Block Ciphers for the Internet of Things\n | first1=Ray\n | last1=Beaulieu\n | first2=Douglas\n | last2=Shors\n | first3=Jason\n | last3=Smith\n | first4=Stefan\n | last4=Treatman-Clark\n | first5=Bryan\n | last5=Weeks\n | first6=Louis\n | last6=Winger\n | url=https://csrc.nist.gov/csrc/media/events/lightweight-cryptography-workshop-2015/documents/papers/session1-shors-paper.pdf\n | date=2015-07-09\n | accessdate=2017-11-23}}</ref>\n\n== Description of the cipher ==\nThe Simon block cipher is a balanced [[Feistel cipher]] with an ''n''-bit word, and therefore the block length is 2''n''.  The key length is a multiple of ''n'' by 2, 3, or 4, which is the value ''m''.  Therefore, a Simon cipher implementation is denoted as Simon2''n''/''nm''.  For example, Simon64/128 refers to the cipher operating on a 64-bit plaintext block (''n''&nbsp;=&nbsp;32) that uses a 128-bit key.<ref name=eprintSimon /> The block component of the cipher is uniform between the Simon implementations; however, the key generation logic is dependent on the implementation of 2, 3 or 4 keys.\n\nSimon supports the following combinations of block sizes, key sizes and number of rounds:<ref name=eprintSimon>{{cite conference|title=The Simon and Speck Families Of Lightweight Block Ciphers |url=http://eprint.iacr.org/2013/404.pdf |work=ePrint|accessdate=2016-06-16}}</ref>\n{| class=\"wikitable\"\n|-\n! Block size (bits)\n! Key size (bits)\n! Rounds\n|-\n| 32\n| 64\n| 32\n|-\n| rowspan=\"2\" | 48\n| 72\n| 36\n|-\n| 96\n| 36\n|-\n| rowspan=\"2\" | 64\n| 96\n| 42\n|-\n| 128\n| 44\n|-\n| rowspan=\"2\" | 96\n| 96\n| 52\n|-\n| 144\n| 54\n|-\n| rowspan=\"3\" | 128\n| 128\n| 68\n|-\n| 192\n| 69\n|-\n| 256\n| 72\n|}\n\n=== Description of the key schedule ===\nLet <math> S^{j}</math> notate a left [[circular shift]] by <math>j</math> bits.\n\nThe key schedule is mathematically described as \n\n<math>\n k_{i+m} = \\left\\{\n\\begin{array}{ll}\n         c\\oplus\\left(z_j\\right)_i\\oplus k_i \\oplus\\left(I\\oplus S^{-1}\\right)\\left(S^{-3}k_{i+1}\\right),&m=2\\\\\n         c\\oplus\\left(z_j\\right)_i\\oplus k_i \\oplus\\left(I\\oplus S^{-1}\\right)\\left(S^{-3}k_{i+2}\\right),&m=3\\\\\n         c\\oplus\\left(z_j\\right)_i\\oplus k_i \\oplus\\left(I\\oplus S^{-1}\\right)\\left(S^{-3}k_{i+3}\\oplus k_{i+1}\\right),&m=4\\\\\n\\end{array}\\right.\n</math>\n\n\n\nThe key schedule structure may or may not be balanced.  The key word count of <math>m</math> is used to determine the structure of the key expansion, resulting in a total bit width of  <math>m*n</math>.  The key word expansion consists of a right shift, XOR and a constant sequence, <math>z_x</math>.  The <math>z_x</math> bit operates on the lowest bit of the key word once per round<ref name=ieeeSimonTool />.\n\n==== Description of the constant sequence ====\n\nThe constant sequence,  <math>z_x </math>, is created by a Linear Feedback Shift Register ([[LFSR]]).  The logical sequence of bit constants is set by the value of the key and block sizes.   The LFSR is created by a 5-bit field.  The constant bit operates on a key block once per round on the lowest bit in order to add non-key-dependent entropy to the key schedule. The LFSR has different logic for each  <math>z_x</math> sequence; however, the initial condition is the same for encryption.  The initial condition of the LFSR for decryption varies on the round.\n\n{| class=\"wikitable sortable\"\n|-\n! Constant Sequence\n|-\n| <math>z_0 = 11111010001001010110000111001101111101000100101011000011100110</math>\n|-\n| <math>z_1 = 10001110111110010011000010110101000111011111001001100001011010</math>\n|-\n| <math>z_2 = 10101111011100000011010010011000101000010001111110010110110011</math>\n|-\n| <math>z_3 = 11011011101011000110010111100000010010001010011100110100001111</math>\n|-\n| <math>z_4 = 11010001111001101011011000100000010111000011001010010011101111</math>\n|}\n\n== Cryptanalysis ==\n\nThe designers claim that Simon, though a \"lightweight\" cipher, is designed to have the full security possible for each block and key size, against standard [[Chosen-plaintext attack|chosen-plaintext (CPA)]] and [[Chosen-ciphertext attack|chosen-ciphertext (CCA)]] attacks.  Resistance against [[related-key attack]]s was also stated as a goal, though a less crucial one as attacks in that model are not relevant for typical use cases.<ref name=\"design_notes_jan2018\">{{Cite web\n | date=2018-01-19\n | title=Notes on the design and analysis of Simon and Speck\n | url=https://eprint.iacr.org/2017/560.pdf\n | accessdate=2018-06-13\n }}</ref>{{rp|2}}  No effort was made to resist attacks in the [[known-key distinguishing attack]] model, nor did the designers evaluate Simon for use as a [[hash function]].<ref name=\"Beaulieu2013\">{{cite web\n| title=The SIMON and SPECK Families of Lightweight Block Ciphers\n| first1=Ray\n| last1=Beaulieu\n| first2=Douglas\n| last2=Shors\n| first3=Jason\n| last3=Smith\n| first4=Stefan\n| last4=Treatman-Clark\n| first5=Bryan\n| last5=Weeks\n| first6=Louis\n| last6=Wingers\n| url=https://eprint.iacr.org/2013/404\n| date=2013-06-19\n| accessdate=2016-09-20}}</ref>\n\nAs of 2018, no successful attack on full-round Simon of any variant is known.  Due to interest in Simon and Speck, about 70 cryptanalysis papers have been published on them.<ref name=\"design_notes_jan2018\"/>{{rp|10}}  As is typical for [[Block_cipher#Iterated_block_ciphers|iterated ciphers]], reduced-round variants have been successfully attacked.  The best published attacks on Simon in the standard attack model (CPA/CCA with unknown key) are [[differential cryptanalysis]] attacks; these make it through about 70\u201375% of the rounds of most variants, though these best attacks are only marginally faster than [[Brute-force attacks|brute-force]].<ref name=\"linear_hull\">{{Cite web\n | last1=Chen\n | first1=Huaifeng \n | last2=Wang\n | first2=Xiaoyun \n | date=2018-01-19\n | title=Improved Linear Hull Attack on Round-Reduced SIMON with Dynamic Key-guessing Techniques\n | url=https://eprint.iacr.org/2015/666.pdf\n | accessdate=2018-06-13\n }}</ref><ref name=\"integral_attacks\">{{Cite journal\n | last1=Chu\n | first1=Zhihui \n | last2=Chen\n | first2=Huaifeng \n | last3=Xiaoyun\n | first3=Wang \n | last4=Dong\n | first4=Xiaoyang \n | last5=Li\n | first5=Lu \n | date=2018-01-19\n | title=Improved Integral Attacks on SIMON32 and SIMON48 with Dynamic Key-Guessing Techniques\n | journal=Security and Communication Networks\n | volume=2018 \n | pages=5160237:1\u20135160237:11\n | doi=10.1155/2018/5160237 \n }}</ref>\n<ref name=\"lee2018_differential\">{{cite journal\n | title=Calculating the Approximate Probability of Differentials for ARX-Based Cipher Using SAT Solver\n | first1=HoChang\n | last1=Lee\n | first2=Seojin\n | last2=Kim\n | first3=HyungChul\n | last3=Kang\n | first4=Deukjo\n | last4=Hong\n | first5=Jaechul\n | last5=Sung\n | first6=Seokhie\n | last6=Hong\n | journal=Journal of the Korea Institute of Information Security and Cryptology\n | date=February 2018\n | volume=28\n | number=1\n | pages=15\u201324\n | language=Korean\n | doi=10.13089/JKIISC.2018.28.1.15\n }}</ref><ref name=\"design_notes_jan2018\"/>{{rp|12}}  The design team states that while designing Simon, they found differential attacks to be the limiting attacks, i.e. the type of attack that makes it through the most rounds; they then set the number of rounds to leave a security margin similar to [[Advanced Encryption Standard|AES-128]]'s at approximately 30%.<ref name=\"design_notes_jan2018\"/>{{rp|12\u201313}}\n\n{| class=\"wikitable\"\n|+ Best known attacks on Simon (in standard attack model)\n|-\n! Variant\n! Rounds attacked\n! Time complexity\n! Data complexity\n! Attack type\n|-\n| Simon128/256\n| 53/72 (74%)\n| 2<sup>248</sup>\n| 2<sup>127.6</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon128/192\n| 51/69 (74%)\n| 2<sup>184</sup>\n| 2<sup>127.6</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon128/128\n| 49/68 (72%) \n| 2<sup>120</sup>\n| 2<sup>127.6</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon96/144\n| 38/54 (70%)\n| 2<sup>136</sup>\n| 2<sup>95.2</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon96/96\n| 37/52 (71%)\n| 2<sup>88</sup>\n| 2<sup>95.2</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon64/128\n| 31/44 (70%)\n| 2<sup>120</sup>\n| 2<sup>63.5</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon64/96\n| 30/42 (71%)\n| 2<sup>88</sup>\n| 2<sup>63.5</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon48/96\n| 25/36 (69%)\n| 2<sup>80</sup>\n| 2<sup>47.9</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon48/72\n| 24/36 (67%) \n| 2<sup>56</sup>\n| 2<sup>47.9</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon32/64\n| 24/32 (75%)\n| 2<sup>63</sup>\n| 2<sup>32</sup>\n| Integral<ref name=\"integral_attacks\"/>\n|}\n\nSimon has been criticized for having too small a security margin, i.e. too few rounds between the best attacks and the full cipher, in comparison to more conservative ciphers such as [[Salsa20#ChaCha_variant|ChaCha20]].<ref>{{cite tweet\n | user=hashbreaker\n | number=719889001444839424\n | first=Daniel J.\n | last=Bernstein\n | date=2016-04-12\n | accessdate=2018-06-13\n | title=NSA claims that having 70% of Simon+Speck broken is ok.\n | url=https://twitter.com/hashbreaker/status/719889001444839424\n}}</ref>\nCiphers with small security margins are more likely to be broken by future advances in [[cryptanalysis]].  Simon's design team counters that there is a real-world cost to unnecessarily large security margins, especially on lightweight devices, that cryptanalysis during the design phase allowed the number of rounds to be set appropriately, and that they targeted AES's security margin.<ref name=\"design_notes_jan2018\"/>{{rp|17}}\n\nSimon includes a round counter in the [[key schedule]].  The designers state this was included to block [[Slide_attack|slide]] and [[rotational cryptanalysis]] attacks.<ref name=\"design_notes_jan2018\"/>{{rp|16}}  Still, rotational-XOR cryptanalysis has been used to find [[Distinguishing_attack|distinguishers]] against reduced-round versions of related ciphers like Speck.<ref name=\"liu2017_rotational\">{{cite web\n | title=Rotational-XOR Cryptanalysis of Reduced-round SPECK\n | first1=Yunwen\n | last1=Liu\n | first2=Glenn \n | last2=De Witte\n | first3=Adri\u00e1n\n | last3=Ranea\n | first4=Tomer\n | last4=Ashur\n | date=2017\n | url=https://eprint.iacr.org/2017/1036.pdf\n | accessdate=2018-06-13\n}}</ref> Though the authors don't describe standard key-recovery attacks based on their distinguishers, their best distinguishers on Simon32 and Simon48 in the known-key distinguishing attack model for certain [[weak key]] classes make it through slightly more rounds than the best differential distinguishers.  One of the authors has said that his research was resource-constrained and that rotational-XOR distinguishers on more rounds are probably possible. The designers also state that Simon was not designed to resist known-key distinguishing attacks (which do not directly compromise the confidentiality of ciphers).<ref name=Beaulieu2013/>{{rp|8}}\n\nThe designers state that NSA cryptanalysis found the algorithms to have no weaknesses, and security commensurate with their key lengths.<ref name=\"Beaulieu2015\"/>{{rp|2}}  The design team says that their cryptanalysis included linear and differential cryptanalysis using standard techniques such as Matsui's algorithm and SAT/SMT solvers, though a full list of techniques used is not given.<ref name=design_notes_jan2018/>{{rp|10}}  Simon's designers have been criticized for not providing more details on NSA cryptanalysis of the ciphers.<ref name=\"ashur_linux-crypto\"/>\n\nThe NSA has approved Simon128/256 and Speck128/256 for use in U.S. National Security Systems, though AES-256 is still recommended for non-constrained applications.<ref name=\"Algorithms-IA-Needs-2016\">{{cite web\n | title=Algorithms to Support the Evolution of Information Assurance Needs\n | url=https://www.iad.gov/iad/library/ia-guidance/ia-solutions-for-classified/algorithm-guidance/algorithms-support-evolution-ia-needs.cfm\n | author=National Security Agency\n | date=2016-11-18\n}}</ref>\n\n== Standardization efforts and controversies ==\n\nInitial attempts to standardise Simon and Speck failed to meet [[International Organization for Standardization]] super-majority required by the process and the ciphers were not adopted.<ref>[https://www.spinics.net/lists/linux-crypto/msg33291.html Insights an reasons why Speck and Simon have been rejected from ISO standardization]</ref><ref name=\"ashur_linux-crypto\">{{cite web\n |title=[PATCH v2 0/5] crypto: Speck support\n |first=Tomer\n |last=Ashur\n |url=https://www.spinics.net/lists/linux-crypto/msg33291.html\n}}</ref> Expert delegates to the ISO from several countries including Germany, Japan and Israel opposed the efforts by the NSA to standardise the Simon and [[Speck (cipher)|Speck]] ciphers, citing concerns that the NSA is pushing for their standardisation with knowledge of exploitable weaknesses in the ciphers. The position was based on partial evidence of weaknesses in the ciphers, lack of clear need for standardisation of the new ciphers, and the NSA's previous involvement in the creation and promotion of the backdoored [[Dual_EC_DRBG]] cryptographic algorithm.<ref>{{cite news|title=Distrustful U.S. allies force spy agency to back down in encryption fight|url=https://www.reuters.com/article/us-cyber-standards-insight/distrustful-u-s-allies-force-spy-agency-to-back-down-in-encryption-fight-idUSKCN1BW0GV|newspaper=Reuters|date=2017-09-21}}</ref>\n\nIn response to concerns, the NSA stated that more than 70 security analysis papers from some of the world's leading cryptographers support NSA's conclusion that the algorithms are secure and NSA affirmed that it is not aware of any cryptanalytic techniques that would allow them or anyone else to exploit Simon or Speck.\n\nAfter initial attempts to standardise the ciphers failed, the ISO standardised Simon and Speck in other working groups. As of October 2018, the Simon and Speck ciphers have been standardized by ISO as a part of the RFID air interface standard, International Standard ISO/29167-21 (for Simon) and International Standard ISO/29167-22 (for Speck), making them available for use by commercial entities.\n\n== See also ==\n* [[Balanced boolean function]]\n* [[Bent function]]\n\n== References ==\n{{reflist}}\n\n{{cryptography navbox | block}}\n\n[[Category:Block ciphers]]\n[[Category:Feistel ciphers]]\n[[Category:National Security Agency cryptography]]\n", "text_old": "{{NPOV|date=June 2018}}\n{{Infobox block cipher\n| name          = Simon\n| image         = [[Image:Simon block cipher.svg|280px|center]]\n| caption       = One round of Simon\n| designers     = Ray Beaulieu, Douglas Shors, Jason Smith, Stefan Treatman-Clark, Bryan Weeks, Louis Wingers [[National Security Agency|NSA]]\n| publish date  = 2013<ref name=eprintSimon />\n| derived from  =\n| derived to    =\n| related to    = [[Speck (cipher)|Speck]]\n| certification =\n| key size      = 64, 72, 96, 128, 144, 192 or 256 bits\n| block size    = 32, 48, 64, 96 or 128 bits\n| structure     = Balanced [[Feistel network]]\n| rounds        = 32, 36, 42, 44, 52, 54, 68, 69 or 72 (depending on block and key size)\n| speed         = 7.5 [[cycles per byte|cpb]] (21.6 without [[Streaming SIMD Extensions|SSE]]) on Intel Xeon 5640 (Simon128/128)\n| cryptanalysis = [[Differential cryptanalysis]] can break 46 rounds of Simon128/128 with 2<sup>125.6</sup> data, 2<sup>40.6</sup> bytes memory and time complexity of 2<sup>125.7</sup> with success rate of 0.632.<ref>{{cite web|title=Differential and Linear Cryptanalysis of Reduced-Round Simon|url=https://eprint.iacr.org/2013/526|accessdate=2014-04-16}}</ref><ref>{{cite conference |url=https://www.iacr.org/workshops/fse2014/slides-09_1.pdf |authors=Farzaneh Abed, Eik List, [[Stefan Lucks]], Jakob Wenzel |date=5 March 2014 |title=Differential Cryptanalysis of Round-Reduced Simon and Speck |conference=[[Fast Software Encryption|FSE]] 2014 |work=conference slides}}</ref><ref>{{cite document|authors=Hoda Alkhzaimi, Martin Lauridsen |date=28 Aug 2013 |title=Cryptanalysis of the SIMON Family of Block Ciphers|url=https://eprint.iacr.org/2013/543.pdf}}</ref>}}\n\n'''Simon''' is a family of lightweight [[block cipher]]s publicly released by the [[National Security Agency]] (NSA) in June 2013.<ref>{{cite web|last=Schneier|first=Bruce|title=SIMON and SPECK: New NSA Encryption Algorithms |work=Schneier on Security |url=https://www.schneier.com/blog/archives/2013/07/simon_and_speck.html|accessdate=2013-07-17}}</ref><ref name=eprintSimon /> Simon has been optimized for performance in hardware implementations, while its sister algorithm, [[Speck (cipher)|Speck]], has been optimized for software implementations.<ref>{{cite web |url=http://www.rfidjournal.com/articles/view?13288 |author=Claire Swedberg |date=17 July 2015 |title=NSA Offers Block Ciphers to Help Secure RFID Transmissions |work=RFID Journal }}</ref><ref name=ieeeSimonTool>{{cite journal |author=Brian Degnan and Gregory Durgin |date=10 November 2017 |title=Simontool: Simulation Support for the Simon Cipher |journal=IEEE Journal of Radio Frequency Identification |volume=1 |issue=2 |pages=195\u2013201 |doi=10.1109/JRFID.2017.2771216 |bibcode=2017IJRFI...1..195D }}</ref>\n\nThe NSA began working on the Simon and Speck ciphers in 2011. The agency anticipated some agencies in the US federal government would need a cipher that would operate well on a diverse collection of [[Internet of Things]] devices while maintaining an acceptable level of security.<ref name=Beaulieu2015>{{cite web\n | title=Simon and Speck: Block Ciphers for the Internet of Things\n | first1=Ray\n | last1=Beaulieu\n | first2=Douglas\n | last2=Shors\n | first3=Jason\n | last3=Smith\n | first4=Stefan\n | last4=Treatman-Clark\n | first5=Bryan\n | last5=Weeks\n | first6=Louis\n | last6=Winger\n | url=https://csrc.nist.gov/csrc/media/events/lightweight-cryptography-workshop-2015/documents/papers/session1-shors-paper.pdf\n | date=2015-07-09\n | accessdate=2017-11-23}}</ref>\n\n== Description of the cipher ==\nThe Simon block cipher is a balanced [[Feistel cipher]] with an ''n''-bit word, and therefore the block length is 2''n''.  The key length is a multiple of ''n'' by 2, 3, or 4, which is the value ''m''.  Therefore, a Simon cipher implementation is denoted as Simon2''n''/''nm''.  For example, Simon64/128 refers to the cipher operating on a 64-bit plaintext block (''n''&nbsp;=&nbsp;32) that uses a 128-bit key.<ref name=eprintSimon /> The block component of the cipher is uniform between the Simon implementations; however, the key generation logic is dependent on the implementation of 2, 3 or 4 keys.\n\nSimon supports the following combinations of block sizes, key sizes and number of rounds:<ref name=eprintSimon>{{cite conference|title=The Simon and Speck Families Of Lightweight Block Ciphers |url=http://eprint.iacr.org/2013/404.pdf |work=ePrint|accessdate=2016-06-16}}</ref>\n{| class=\"wikitable\"\n|-\n! Block size (bits)\n! Key size (bits)\n! Rounds\n|-\n| 32\n| 64\n| 32\n|-\n| rowspan=\"2\" | 48\n| 72\n| 36\n|-\n| 96\n| 36\n|-\n| rowspan=\"2\" | 64\n| 96\n| 42\n|-\n| 128\n| 44\n|-\n| rowspan=\"2\" | 96\n| 96\n| 52\n|-\n| 144\n| 54\n|-\n| rowspan=\"3\" | 128\n| 128\n| 68\n|-\n| 192\n| 69\n|-\n| 256\n| 72\n|}\n\n=== Description of the key schedule ===\nLet <math> S^{j}</math> notate a left [[circular shift]] by <math>j</math> bits.\n\nThe key schedule is mathematically described as \n\n<math>\n k_{i+m} = \\left\\{\n\\begin{array}{ll}\n         c\\oplus\\left(z_j\\right)_i\\oplus k_i \\oplus\\left(I\\oplus S^{-1}\\right)\\left(S^{-3}k_{i+1}\\right),&m=2\\\\\n         c\\oplus\\left(z_j\\right)_i\\oplus k_i \\oplus\\left(I\\oplus S^{-1}\\right)\\left(S^{-3}k_{i+2}\\right),&m=3\\\\\n         c\\oplus\\left(z_j\\right)_i\\oplus k_i \\oplus\\left(I\\oplus S^{-1}\\right)\\left(S^{-3}k_{i+3}\\oplus k_{i+1}\\right),&m=4\\\\\n\\end{array}\\right.\n</math>\n\n\n\nThe key schedule structure may or may not be balanced.  The key word count of <math>m</math> is used to determine the structure of the key expansion, resulting in a total bit width of  <math>m*n</math>.  The key word expansion consists of a right shift, XOR and a constant sequence, <math>z_x</math>.  The <math>z_x</math> bit operates on the lowest bit of the key word once per round<ref name=ieeeSimonTool />.\n\n==== Description of the constant sequence ====\n\nThe constant sequence,  <math>z_x </math>, is created by a Linear Feedback Shift Register ([[LFSR]]).  The logical sequence of bit constants is set by the value of the key and block sizes.   The LFSR is created by a 5-bit field.  The constant bit operates on a key block once per round on the lowest bit in order to add non-key-dependent entropy to the key schedule. The LFSR has different logic for each  <math>z_x</math> sequence; however, the initial condition is the same for encryption.  The initial condition of the LFSR for decryption varies on the round.\n\n{| class=\"wikitable sortable\"\n|-\n! Constant Sequence\n|-\n| <math>z_0 = 11111010001001010110000111001101111101000100101011000011100110</math>\n|-\n| <math>z_1 = 10001110111110010011000010110101000111011111001001100001011010</math>\n|-\n| <math>z_2 = 10101111011100000011010010011000101000010001111110010110110011</math>\n|-\n| <math>z_3 = 11011011101011000110010111100000010010001010011100110100001111</math>\n|-\n| <math>z_4 = 11010001111001101011011000100000010111000011001010010011101111</math>\n|}\n\n== Cryptanalysis ==\n\nThe designers claim that Simon, though a \"lightweight\" cipher, is designed to have the full security possible for each block and key size, against standard [[Chosen-plaintext attack|chosen-plaintext (CPA)]] and [[Chosen-ciphertext attack|chosen-ciphertext (CCA)]] attacks.  Resistance against [[related-key attack]]s was also stated as a goal, though a less crucial one as attacks in that model are not relevant for typical use cases.<ref name=\"design_notes_jan2018\">{{Cite web\n | date=2018-01-19\n | title=Notes on the design and analysis of Simon and Speck\n | url=https://eprint.iacr.org/2017/560.pdf\n | accessdate=2018-06-13\n }}</ref>{{rp|2}}  No effort was made to resist attacks in the [[known-key distinguishing attack]] model, nor did the designers evaluate Simon for use as a [[hash function]].<ref name=\"Beaulieu2013\">{{cite web\n| title=The SIMON and SPECK Families of Lightweight Block Ciphers\n| first1=Ray\n| last1=Beaulieu\n| first2=Douglas\n| last2=Shors\n| first3=Jason\n| last3=Smith\n| first4=Stefan\n| last4=Treatman-Clark\n| first5=Bryan\n| last5=Weeks\n| first6=Louis\n| last6=Wingers\n| url=https://eprint.iacr.org/2013/404\n| date=2013-06-19\n| accessdate=2016-09-20}}</ref>\n\nAs of 2018, no successful attack on full-round Simon of any variant is known.  Due to interest in Simon and Speck, about 70 cryptanalysis papers have been published on them.<ref name=\"design_notes_jan2018\"/>{{rp|10}}  As is typical for [[Block_cipher#Iterated_block_ciphers|iterated ciphers]], reduced-round variants have been successfully attacked.  The best published attacks on Simon in the standard attack model (CPA/CCA with unknown key) are [[differential cryptanalysis]] attacks; these make it through about 70\u201375% of the rounds of most variants, though these best attacks are only marginally faster than [[Brute-force attacks|brute-force]].<ref name=\"linear_hull\">{{Cite web\n | last1=Chen\n | first1=Huaifeng \n | last2=Wang\n | first2=Xiaoyun \n | date=2018-01-19\n | title=Improved Linear Hull Attack on Round-Reduced SIMON with Dynamic Key-guessing Techniques\n | url=https://eprint.iacr.org/2015/666.pdf\n | accessdate=2018-06-13\n }}</ref><ref name=\"integral_attacks\">{{Cite journal\n | last1=Chu\n | first1=Zhihui \n | last2=Chen\n | first2=Huaifeng \n | last3=Xiaoyun\n | first3=Wang \n | last4=Dong\n | first4=Xiaoyang \n | last5=Li\n | first5=Lu \n | date=2018-01-19\n | title=Improved Integral Attacks on SIMON32 and SIMON48 with Dynamic Key-Guessing Techniques\n | journal=Security and Communication Networks\n | volume=2018 \n | pages=5160237:1\u20135160237:11\n | doi=10.1155/2018/5160237 \n }}</ref>\n<ref name=\"lee2018_differential\">{{cite journal\n | title=Calculating the Approximate Probability of Differentials for ARX-Based Cipher Using SAT Solver\n | first1=HoChang\n | last1=Lee\n | first2=Seojin\n | last2=Kim\n | first3=HyungChul\n | last3=Kang\n | first4=Deukjo\n | last4=Hong\n | first5=Jaechul\n | last5=Sung\n | first6=Seokhie\n | last6=Hong\n | journal=Journal of the Korea Institute of Information Security and Cryptology\n | date=February 2018\n | volume=28\n | number=1\n | pages=15\u201324\n | language=Korean\n | doi=10.13089/JKIISC.2018.28.1.15\n }}</ref><ref name=\"design_notes_jan2018\"/>{{rp|12}}  The design team states that while designing Simon, they found differential attacks to be the limiting attacks, i.e. the type of attack that makes it through the most rounds; they then set the number of rounds to leave a security margin similar to [[Advanced Encryption Standard|AES-128]]'s at approximately 30%.<ref name=\"design_notes_jan2018\"/>{{rp|12\u201313}}\n\n{| class=\"wikitable\"\n|+ Best known attacks on Simon (in standard attack model)\n|-\n! Variant\n! Rounds attacked\n! Time complexity\n! Data complexity\n! Attack type\n|-\n| Simon128/256\n| 53/72 (74%)\n| 2<sup>248</sup>\n| 2<sup>127.6</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon128/192\n| 51/69 (74%)\n| 2<sup>184</sup>\n| 2<sup>127.6</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon128/128\n| 49/68 (72%) \n| 2<sup>120</sup>\n| 2<sup>127.6</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon96/144\n| 38/54 (70%)\n| 2<sup>136</sup>\n| 2<sup>95.2</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon96/96\n| 37/52 (71%)\n| 2<sup>88</sup>\n| 2<sup>95.2</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon64/128\n| 31/44 (70%)\n| 2<sup>120</sup>\n| 2<sup>63.5</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon64/96\n| 30/42 (71%)\n| 2<sup>88</sup>\n| 2<sup>63.5</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon48/96\n| 25/36 (69%)\n| 2<sup>80</sup>\n| 2<sup>47.9</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon48/72\n| 24/36 (67%) \n| 2<sup>56</sup>\n| 2<sup>47.9</sup>\n| Linear Hull<ref name=\"linear_hull\"/>\n|-\n| Simon32/64\n| 24/32 (75%)\n| 2<sup>63</sup>\n| 2<sup>32</sup>\n| Integral<ref name=\"integral_attacks\"/>\n|}\n\nSimon has been criticized for having too small a security margin, i.e. too few rounds between the best attacks and the full cipher, in comparison to more conservative ciphers such as [[Salsa20#ChaCha_variant|ChaCha20]].<ref>{{cite tweet\n | user=hashbreaker\n | number=719889001444839424\n | first=Daniel J.\n | last=Bernstein\n | date=2016-04-12\n | accessdate=2018-06-13\n | title=NSA claims that having 70% of Simon+Speck broken is ok.\n | url=https://twitter.com/hashbreaker/status/719889001444839424\n}}</ref>\nCiphers with small security margins are more likely to be broken by future advances in [[cryptanalysis]].  Simon's design team counters that there is a real-world cost to unnecessarily large security margins, especially on lightweight devices, that cryptanalysis during the design phase allowed the number of rounds to be set appropriately, and that they targeted AES's security margin.<ref name=\"design_notes_jan2018\"/>{{rp|17}}\n\nSimon includes a round counter in the [[key schedule]].  The designers state this was included to block [[Slide_attack|slide]] and [[rotational cryptanalysis]] attacks.<ref name=\"design_notes_jan2018\"/>{{rp|16}}  Still, rotational-XOR cryptanalysis has been used to find [[Distinguishing_attack|distinguishers]] against reduced-round versions of related ciphers like Speck.<ref name=\"liu2017_rotational\">{{cite web\n | title=Rotational-XOR Cryptanalysis of Reduced-round SPECK\n | first1=Yunwen\n | last1=Liu\n | first2=Glenn De\n | last2=Witte\n | first3=Adri\u00e1n\n | last3=Ranea\n | first4=Tomer\n | last4=Ashur\n | date=2017\n | url=https://eprint.iacr.org/2017/1036.pdf\n | accessdate=2018-06-13\n}}</ref> Though the authors don't describe standard key-recovery attacks based on their distinguishers, their best distinguishers on Simon32 and Simon48 in the known-key distinguishing attack model for certain [[weak key]] classes make it through slightly more rounds than the best differential distinguishers.  One of the authors has said that his research was resource-constrained and that rotational-XOR distinguishers on more rounds are probably possible. The designers also state that Simon was not designed to resist known-key distinguishing attacks (which do not directly compromise the confidentiality of ciphers).<ref name=Beaulieu2013/>{{rp|8}}\n\nThe designers state that NSA cryptanalysis found the algorithms to have no weaknesses, and security commensurate with their key lengths.<ref name=\"Beaulieu2015\"/>{{rp|2}}  The design team says that their cryptanalysis included linear and differential cryptanalysis using standard techniques such as Matsui's algorithm and SAT/SMT solvers, though a full list of techniques used is not given.<ref name=design_notes_jan2018/>{{rp|10}}  Simon's designers have been criticized for not providing more details on NSA cryptanalysis of the ciphers.<ref name=\"ashur_linux-crypto\"/>\n\nThe NSA has approved Simon128/256 and Speck128/256 for use in U.S. National Security Systems, though AES-256 is still recommended for non-constrained applications.<ref name=\"Algorithms-IA-Needs-2016\">{{cite web\n | title=Algorithms to Support the Evolution of Information Assurance Needs\n | url=https://www.iad.gov/iad/library/ia-guidance/ia-solutions-for-classified/algorithm-guidance/algorithms-support-evolution-ia-needs.cfm\n | author=National Security Agency\n | date=2016-11-18\n}}</ref>\n\n== Standardization efforts and controversies ==\n\nInitial attempts to standardise Simon and Speck failed to meet [[International Organization for Standardization]] super-majority required by the process and the ciphers were not adopted.<ref>[https://www.spinics.net/lists/linux-crypto/msg33291.html Insights an reasons why Speck and Simon have been rejected from ISO standardization]</ref><ref name=\"ashur_linux-crypto\">{{cite web\n |title=[PATCH v2 0/5] crypto: Speck support\n |first=Tomer\n |last=Ashur\n |url=https://www.spinics.net/lists/linux-crypto/msg33291.html\n}}</ref> Expert delegates to the ISO from several countries including Germany, Japan and Israel opposed the efforts by the NSA to standardise the Simon and [[Speck (cipher)|Speck]] ciphers, citing concerns that the NSA is pushing for their standardisation with knowledge of exploitable weaknesses in the ciphers. The position was based on partial evidence of weaknesses in the ciphers, lack of clear need for standardisation of the new ciphers, and the NSA's previous involvement in the creation and promotion of the backdoored [[Dual_EC_DRBG]] cryptographic algorithm.<ref>{{cite news|title=Distrustful U.S. allies force spy agency to back down in encryption fight|url=https://www.reuters.com/article/us-cyber-standards-insight/distrustful-u-s-allies-force-spy-agency-to-back-down-in-encryption-fight-idUSKCN1BW0GV|newspaper=Reuters|date=2017-09-21}}</ref>\n\nIn response to concerns, the NSA stated that more than 70 security analysis papers from some of the world's leading cryptographers support NSA's conclusion that the algorithms are secure and NSA affirmed that it is not aware of any cryptanalytic techniques that would allow them or anyone else to exploit Simon or Speck.\n\nAfter initial attempts to standardise the ciphers failed, the ISO standardised Simon and Speck in other working groups. As of October 2018, the Simon and Speck ciphers have been standardized by ISO as a part of the RFID air interface standard, International Standard ISO/29167-21 (for Simon) and International Standard ISO/29167-22 (for Speck), making them available for use by commercial entities.\n\n== See also ==\n* [[Balanced boolean function]]\n* [[Bent function]]\n\n== References ==\n{{reflist}}\n\n{{cryptography navbox | block}}\n\n[[Category:Block ciphers]]\n[[Category:Feistel ciphers]]\n[[Category:National Security Agency cryptography]]\n", "name_user": "\u05ea\u05d5\u05de\u05e8 \u05d0.", "label": "safe", "comment": "Fixing Glenn's name", "url_page": "//en.wikipedia.org/wiki/Simon_(cipher)"}
